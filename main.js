(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{b7:()=>g,OP:()=>I,po:()=>C,iJ:()=>k,KM:()=>P,az:()=>x,FK:()=>j,bM:()=>b,Dp:()=>N,Gs:()=>L,Sl:()=>A,vi:()=>z,eU:()=>T,rC:()=>O,CV:()=>w,nx:()=>E});var t="popup__btn-save_type_disabled",n={popupSelector:".popup",formSelector:".popup__form",inputSelector:".popup__item",buttonSelector:".popup__btn-save",errorInputSelector:"popup__item_type_error",errorContainerSelector:"popup__input-error_active"},o=function(e,t){e.classList.add(t),e.disabled=!0},c=function(e){e.classList.add("popup_opened"),document.addEventListener("keydown",a),e.addEventListener("mousedown",u)},r=function(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",a),e.removeEventListener("mousedown",u)};function a(e){"Escape"===e.key&&u()}function u(){var e=document.querySelector(".popup_opened");r(e)}function i(e){document.querySelector(".popup_opened").querySelector(".popup__btn-save").textContent=e?"Сохранение...":"Создать"}document.querySelectorAll(".popup__btn-close").forEach((function(e){e.addEventListener("click",(function(e){var t=e.target.closest(".popup");r(t)}))}));var l="https://mesto.nomoreparties.co/v1/plus-cohort-2",s="0c2cab2b-faf8-4ab5-8a1f-3a0ce4776b46",p="",d=document.querySelector(".elements__items");function _(e){d.prepend(function(e){var t=I.querySelector(".elements__item").cloneNode(!0),n=t.querySelector(".elements__image");return n.src="".concat(e.link),n.alt="".concat(e.name),t.querySelector(".elements__name").textContent="".concat(e.name),t.querySelector(".elements__vector").addEventListener("click",(function(t){return function(e,t){e.target.classList.toggle("elements__vector_active"),function(e,t){return e.target.classList.contains("elements__vector_active")?fetch("".concat(l,"/cards/likes/").concat(t._id),{method:"PUT",headers:{authorization:"".concat(s),"Content-Type":"application/json"}}):fetch("".concat(l,"/cards/likes/").concat(t._id),{method:"DELETE",headers:{authorization:"".concat(s),"Content-Type":"application/json"}})}(e,t).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(t){e.target.parentNode.querySelector(".elements__counter").textContent=t.likes.length})).catch((function(e){console.log(e)}))}(t,e)})),t.querySelector(".elements__trash").addEventListener("click",(function(e){e.target.closest(".elements__item").remove()})),e.owner._id===p&&t.querySelector(".elements__trash").classList.add("elements__trash_type_active"),t.querySelector(".elements__counter").textContent=e.likes.length,n.addEventListener("click",(function(){return function(e){z.src="".concat(e.link),z.alt="".concat(e.name),A.textContent="".concat(e.name),c(T)}(e)})),t}(e))}var m=document.querySelector(".popup__form_type_avatar");document.querySelector(".profile__image-button").addEventListener("click",(function(){c(b)})),m.addEventListener("submit",(function(){f(),m.reset()}));var f=function(){var e;i(!0),(e=E.value,fetch("".concat(l,"/users/me/avatar"),{method:"PATCH",headers:{authorization:"".concat(s),"Content-Type":"application/json"},body:JSON.stringify({avatar:e})})).then((function(e){return e.ok?e.json():Promise.reject("ошибка: ".concat(e.status))})).then((function(e){g.src="url('".concat(e.avatar,"'')"),r(b)})).catch((function(e){console.log(e)})).finally((function(){i(!1)}))};document.querySelector(".profile__add-button").addEventListener("click",(function(){c(j)}));var y=document.querySelector(".popup__form_type_addcard");y.addEventListener("submit",(function(){var e,t;i(!0),(e=x.value,t=P.value,fetch("".concat(l,"/cards"),{method:"POST",headers:{authorization:"".concat(s),"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})})).then((function(e){return e.ok?e.json():Promise.reject("ошибка: ".concat(e.status))})).then((function(e){_(e),r(j)})).catch((function(e){console.log(e)})).finally((function(){i(!1)})),y.reset(),o(document.getElementById("editCardBtn"),"popup__btn-save_type_disabled")})),document.querySelector(".profile__edit-button").addEventListener("click",(function(){c(L),C.value=O.textContent,k.value=w.textContent}));var v=document.querySelector(".popup__form_type_edit"),h=v.querySelector(".popup__item_el_name"),S=v.querySelector(".popup__item_el_text");v.addEventListener("submit",(function(){var e,t;i(!0),(e=h.value,t=S.value,fetch("".concat(l,"/users/me"),{method:"PATCH",headers:{authorization:"".concat(s),"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})})).then((function(e){return e.ok?e.json():Promise.reject("ошибка: ".concat(e.status))})).then((function(e){O.textContent=e.name,w.textContent=e.about,r(L)})).catch((function(e){console.log(e)})).finally((function(){i(!1)}))}));var q,b=document.querySelector(".popup_type_avatar"),g=document.querySelector(".profile__image"),E=document.querySelector(".popup__item_el_url"),L=document.querySelector(".popup_type_edit"),C=L.querySelector(".popup__item_el_name"),k=L.querySelector(".popup__item_el_text"),j=document.querySelector(".popup_type_addcard"),x=j.querySelector(".popup__item_el_place"),P=j.querySelector(".popup__item_el_link"),T=document.querySelector(".popup_type_photo"),z=document.querySelector(".popup__image"),A=document.querySelector(".popup__figcaption"),O=document.querySelector(".profile__name"),w=document.querySelector(".profile__text"),I=document.querySelector("#card-template").content,N=(document.querySelector(".elements__image"),document.querySelectorAll(".popup__container"));fetch("".concat(l,"/users/me"),{method:"GET",headers:{authorization:"".concat(s)}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){var t;t=e._id,p=t,O.textContent=e.name,w.textContent=e.about,g.src=e.avatar})).catch((function(e){console.log(e)})),N.forEach((function(e){e.addEventListener("mousedown",(function(e){e.stopPropagation()}))})),q=n,Array.from(document.querySelectorAll(q.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()}));var c=Array.from(e.querySelectorAll(q.inputSelector));c.forEach((function(r){r.addEventListener("input",(function(){var a;(a=r).validity.valid?function(e,t,o){var c=document.getElementById("".concat(e.name,"-error"));e.classList.remove(n.errorInputSelector),c.classList.remove(n.errorContainerSelector),c.textContent=""}(a):function(e,t,o){var c=document.getElementById("".concat(e.name,"-error"));e.classList.add(n.errorInputSelector),c.textContent=e.validationMessage,c.classList.add(n.errorContainerSelector)}(a),function(e,n,c){var r=e.querySelector(c);n.every((function(e){return e.validity.valid}))?function(e,t){e.classList.remove("popup__btn-save_type_disabled"),e.disabled=!1}(r):o(r,t)}(e,c,q.buttonSelector)}))}))})),fetch("".concat(l,"/cards"),{headers:{authorization:"".concat(s)}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){_(e)}))})).catch((function(e){console.log(e)}))})();